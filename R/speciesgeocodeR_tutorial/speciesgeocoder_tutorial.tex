\documentclass[a4paper,titlepage,11pt]{scrreprt}
\usepackage[top=2.5cm, bottom=2.5cm, left=2.5cm, right=2.5cm]{geometry}    
\usepackage[round]{natbib}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{epstopdf}
\usepackage{helvet}
\usepackage[font=small,format=plain,labelfont=bf,up,textfont=normal,up, justification=justified,singlelinecheck=false]{caption}

\renewcommand{\familydefault}{\sfdefault}

\newenvironment{ppl}{\fontfamily{ppl}\selectfont}{\par}

\parskip 12pt
\parindent 0pt
\renewcommand*{\chapterheadstartvskip}{\vspace*{-2cm}}


\linespread{1.5}

\begin{document}


\begin{titlepage}
\vspace*{1cm}
\begin{center}
\huge
\textbf{Tutorial for using the speciesgeocodeR package}\\
\vspace{1cm}
\Large {Alexander Zizka, Antonelli, etc.,  \today} \\
\end{center}

\vspace{1.5cm}
\Large

\normalsize

\textbf{Abstract} The purpose of this manual is to provide easy-to-use instructions for the speciesgeocodeR package for R beginners, and to explain the functionality of the package to more advanced users. The specisgeocodeR package is a collection of R functions designed to link geographical point coordinates with geographical polygons. It is a tool especially suited for biogeographical and ecological questions, i.e the distribution of specimen and species in geographic regions. Based on a list of point coordinates (specimen occurences) and a list of points building the polygons (geographical areas) speciesgeocodeR handles the classification geographic points to geographical areas (point in polygon test) and runs multiple statistical analyses to summarize the results. This includes a nexus file to use the results as direct input for biogeographic analysis linked with phylogenetic trees, as well as summary tables, -graphs and geographical maps. Chapter one of this manual specifies the input-file format, chapter two provides a 3-step tutorial to run a standard analysis, chapter three describes how to use the WWF ecoregions as input polygons and chapter four describes the standard outputfiles. Chapter five is a step-by-step commented script for the use of single functions, chapter six contains a discription of all function in the package and chapter seven shows results of benchmarking tests to give an idea of the computational time needed depending on the size of the dataset. SpeciesgeocodeR is the R implication of the python speciesgeocoder program \citep{XXX}.


\end{titlepage}

\tableofcontents

\chapter{Input files}

All results produced with speciesgeocodeR are based on two input files that can easily be generated using freely available textformatting and GIS software: a list of sample coordinates (e.g. GPS-coordinates of specimen, herafter called ``speciesdata") and a list of polygon points (e.g biomes or national park borders, herafter called ``polygondata"). The package is designed and tested for small-scale (e.g. radiocolar data in combination with national park borders) and large scale (e.g global distribuiton of all birds to biomes) analyses. As an additional feature speciesgeocodeR allows the use of the WWF- Realm/Biome/Eoregion classification as input polygons (see chapter 3).

\textit{Input}-files: The two input files are required to be tab-delimited .txt files with three columns each. For both files, column names must be: �identifier�, �XCOOR�, YCOOR�. In case of the speciesdata the first column contains the species name (or individual name), the second column contains the longitude coordinates (as decimal degrees, e.g. 59.867 for East, or -59.867 for West) and the third column contains latitude coordinates (as decimal degrees, e.g. 59.867 for North, or -59.867 for South). The polygondata should be in the same format: each row represents the coordinates of one polygon corner. The first column contains the polygon identifier, the second one the longitude coordinates, the third one the latitude coordinates. It is important that the coordinates of the first and the last point of each polygon are identical. You can easily export such a file from any GIS program (e.g. QGIS: \url{http://www.qgis.org/en/site/}). If you use  polygondata exported from QGIS or formated for the python version of speciesgeocoder you can use the ConvertPoly() function to convert the format.

When preparing the input files please make sure:
\begin{enumerate}
\item that the order of the columns and the column headers are correct (``identifier", ``XCOOR", ``YCOOR")
\item that your coordinates conform with the limits of the coordinate system (XCOOR between -180 and 180; YCOOR between -90 and 90)
\item that for each polygon in the polygon data the first and last point have identical coordinates.
\end{enumerate}

\chapter{All-in-one: the quick and easy way}

You can run a standard speciesgeocoder analysis with only three commands. The following paragraph will give a simple tutorial for R beginners. Two example scripts (hereafter called \#1 and \#2) are given at the end of the chapter. The example files are also provided in a .txt file with the package, so if you are unfamiliar with the R environment, you can just copy the Example code from there to the R consol (do not forget to change the paths given in capitals). If you are interested in a step by step process or in the use of single functions refer to chapters five and six. The \#numbers refer to codelines in the example scripts:

\begin{enumerate}

\item  Create a new folder in your home directory (the working directory). Copy the speciesgeocoder package (speciesgeocodeR.R) and your two input files into the folder and give them characteristic names (here we will use ``point\_coordinates.txt'' for our speciesdata and ``polygon\_coordinates.txt'' for the polygondata). If you are insecure about the format of your input files or an error occurs right away, check chapter one of this manual or take look at the example files delivered with the package.

\item Start R

\item Tell R where to find the input files and save the outputfiles (\#1.1). You must put the exact path of the folder in the quotation marks. If you use mac (or linux) use / instead of \textbackslash \textbackslash.

\item Load the functions of the speciesgeocoder package into your R session (\#1.2)

\item{Execute the SpeciesGeoCoder() function with the names of your two input files as arguments (\#1.3). Depending on the size of your dataset (especially the number of polygons) this might take a while. The �graphs� argument controls if graphical output is produced (default = T), the``coex"' argument defines if a coexistence matrix for all species in each polygon is produced (default = F, this is only recommended for datasets with small to medium size species number, as it is computationally very expensive)}

\item{Done! Close R, the outputfiles are in your working directory. Summary tables are saved as tab-delimited .txt files, graphs and maps as .pdf files. If problems occur, check your input-files or try using one of the example datasets delivered with the package. If this does not help, you might want to use the step-by-step procedure described in chapter five.}

\item{If your polygondata input file is exported from QGIS and/or is formated for use with the python version of speciesgeocodeR, you can use the ConvertPoly() function to convert it to a format suitable for use with speciegeocodeR (\#2)}

\end{enumerate}

\textbf{Example \#1}\\
\vspace{-0.5cm}
\begin{table}[h]
\resizebox{\textwidth}{!}{
\begin{tabular}{l l p{6cm}}
\textbf{Line} &\textbf{Code} &  \textbf{Explanation}\\

1.1 & \textit{setwd(``YOUR WOKINGDIRECTORY PATH'')}  & Define where to load and save files, e.g. ``C:\textbackslash \textbackslash Desktop\textbackslash \textbackslash data'' \\
1.2 & \textit{source(``speciesgeocodeR.R'')} & load the speciesgeocodeR package\\
1.3 & \textit{SpeciesGeoCoder(``SPECIESDATA'', ``POLYGONDATA'',  graphs = T, coex = F) } & run SpeciesGeoCoder(), e.g ``point\_coordinates.txt'', ``polygon\_coordinates.txt'' \\
\end{tabular}}
\end{table}

\textbf{Example \#2}\\
\vspace{-0.5cm}
\begin{table}[h]
\resizebox{\textwidth}{!}{
\begin{tabular}{l l p{6cm}}
\textbf{Line} &\textbf{Code} &  \textbf{Explanation}\\

2.1 & \textit{setwd(``YOUR WOKINGDIRECTORY PATH'') } &  Define where to load and save files, e.g. ``C:\textbackslash \textbackslash Desktop\textbackslash \textbackslash data''  \\
2.2 & \textit{source(``speciesgeocodeR.R'') } &  load the speciesgeocodeR package\\
2.3 & \textit{poly \textless- ConvertPoly(``POLYGOND INPUTFILE'')} &  load and convert your polygon file\\
2.4 & \textit{write.table(poly, ``polygon\_coordinates.txt'', row.names = F,  sep = ``\textbackslash t'')} & write the new input-file \\
2.5 & \textit{SpeciesGeoCoder(``SPECIESDATA'', ``POLYGONDATA'',  graphs = T, coex = F) } & run SpeciesGeoCoder(), e.g ``point\_coordinates.txt'', ``polygon\_coordinates.txt'' \\
\end{tabular}}
\end{table}

\chapter{Using the WWF Realms/Biomes/Ecoregions as input polygons}
You can use speciesgeocodeR to produce the input polygons for your analysis directly from the global WWF definition of terrestrial Ecoregions (and Realms and Biomes, \citet{WWF}). To do so, download the source files (e.g. from \url{https://worldwildlife.org/publications/terrestrial-ecoregions-of-the-world}) and extract them to your working directory. After you loaded them into R (\#3.3), you can use the WWFpick() function to create the polygon input object for SpeciesGeoCoder() (\#3.4). To use it run SpeciesGeoCoder()  with a normal input table for the pointdata and with the object containing result of WWFpick() as polygondata (\#3.5). The WWFpick() function needs three input objects (\#3.4). When you run SpeciesGeoCodeR() with WWF input polygons you must specify to additional arguments; ``wwf = T'' and scale =``FOCUS SCALE''. The scale arguments defines the scale of clustering of the results (this must be one of``ECOREGION'', ``BIOME'', ``REALM'', \#3.5):

\begin{enumerate}
\item{The WWF shape file stored in an R object, ``wwf'' in the example}
\item{The name of the region of interest. Depending on the scale this for example could be ``Neotropics'', ``Temperate Conifer Forests'' or ``Ethiopian montane moorlands''. It must be a character string included in the scale specified in ``scale''. You can use the WWFnam() function on the shape file object to display all names available (\#3.6). Vectors of names are also possible, e.g. c(``Neotropis'', ``Afrotropis'') or "all" (giving all polygons for the specified scale)}
\item{The scale of interest. This must be one of the following ``REALM'', ``BIOME'', ``ECOREGION''.}
\end{enumerate}
\newpage

\textbf{Example \# 3  WWF terrestrial ecoregions as input polygon}\\
\vspace{-0.5cm}
\begin{table}[h]

\resizebox{\textwidth}{!}{
\begin{tabular}{l l p{6cm}}
\textbf{Line} &\textbf{Code} &  \textbf{Explanation}\\
3.1 & \textit{setwd(``YOUR WOKINGDIRECTORY PATH'')} &   e.g. C:\textbackslash \textbackslash User\textbackslash \textbackslash Desktop \\
3.2 & \textit{source(``speciesgeocodeR.R'')} &  load the speciegeocodeR package \\
3.3 & \textit{wwf \textless- readShapeSpatial(``NAME OF THE SHAPE FILE'')} &  load the WWF shape, name e.g ``wwf\_terr\_ecos.shp''  \\
3.6 & \textit{WWFnam(wwf)} &  Display the area names available for WWFpick()\\
3.4 & \textit{poly \textless- WWFpick(wwf, name  = ``FOCUS REGION'', scale = ``FOCUS SCALE'')} &  pick the polygons of interest, e.g name = ``Neotropics'', scale = ``REALM''\\
3.5 & \textit{SpeciesGeoCoder(``SPECIESDATA'', poly,  graphs = T, coex = F, wwf = T, scale = "FOCUS SCALE FOR CLUSTERING") } & run SpeciesGeoCoder(), e.g ``point\_coordinates.txt'', ``polygon\_coordinates.txt''  \\
\end{tabular}}
\end{table}

\chapter{Output-file description}

With the ``graphs'' and ``coex'' options swiched on, SpeciesGeoCoder() produces 13 outputfiles (1 nexus file, 5 summary tables, 3 barcharts, 3 maps and 1 heatplot). By default all files are saved to the working directory defined before the analysis (\#1.1). The summary tables are tab delimited .txt files and all graphics and maps are put out as .pdf files. Depending on the size of you dataset, some of the graphical representations might not be adequate. \\
\\
\textbf{Barchart\_per\_polygon.pdf}\\
This file contains one barchart for each input polygon showing the total number of occurences for each species in this polygon.\\
\textbf{Barchart\_per\_species.pdf}\\
This file contains one barchart per species, showing the relative number of occurences in each input polygon.\\
\textbf{Heatplot\_coexistence.pdf}\\
This file contains a heat plot showing the coexistence pattern of all species in the analysis. This output is turned of by default. To turn it on use  ``coex = T'' as argument of the SpeciesGeoCoder() function.\\
\textbf{Map\_samples\_overview.pdf}\\
This file contains  an overview map showing all input points and polygons.\\
\textbf{Map\_samples\_per\_polygon.pdf}\\
This file contains one map for each input polygon, showing all occurence points included in the polygon colour-coded for species.\\
\textbf{Map\_samples\_per\_species.pdf}\\
This file contains one map  for each input species showing all polygons and all occurrence points of this species. Point samples classified to any polygon are shown in blue, unclassified samples are shown in red.\\
\textbf{Numer\_of\_species\_per\_polygon.pdf}\\
This file contains a bargraph indicating the number of species per polygon.\\
\textbf{Species\_classification.nex}\\
This is a nexus file containing the area coding for each species (1 = occurence, 0 = absence) for biogeographic analysis in combination with phylogenetic data.\\
\textbf{Sample\_classification\_to\_polygon.txt}\\
This is a summary table showing the classification for each sample point.\\
\textbf{Species\_occurrence\_per\_polygon.txt}\\
This is a summary table showing the presence or absence of every species in the input polygons.\\
\textbf{Species\_number\_per\_polygon.txt}\\
This is a table summarizing the number of species for each polygon.\\
\textbf{Unclassified\_samples.txt}\\
This file contains a map showing all samples that could not be clssified to any of the input polygons.\\

\chapter{Step-by-step: Specific output files}
This is to be written if necessary

\chapter{Function description}
\textbf{BarChartPoly(x, plotout, \dots)}
\textit{Input:} x = a object of class spgeoOUT, plotout = logical indicating if the function will be viewed in the R graphics device or passed to another output function, default is false
\textit{Function:} this function gives out one bar chart per input polygon showing the number of occurrences for each species in this polygon.
\textit{Output:} a series of bar charts\\
\\
\textbf{BarChartSpec(x, plotout, �)}\\
\textit{Input:} x = a object of class spgeoOUT, plotout = logical (T/F)\\
\textit{Function:} this function gives out one bar chart per input species (or identifier) showing the number of occurrences in each polygon. Plotout indicates if the function will be viewed in the R graphics device or passed to another output function, default = FALSE.\\
\textit{Output}: a series of bar charts\\
\\
\textbf{CoExClass(x)}\\
\textit{Input:} x = class spgeoOUT\\
\textit{Function:} this applies CoExClassH() to an object of class spgeoOUT, to add a species coexistence matrix to the object. This considers only species classified to polygons!\\
\textit{Output:} additional slot of the spgeoOUT object containing the coexistence matrix\\
\\
\textbf{CoExClassH(x)}\\
\textit{Input:} x = data.frame of species occurrence numbers per polygon; ncol = number of polygons, nrow = number of species\\
\textit{Function:} calculates a coexistence matrix of species. The number indicates the percentage of the species in the row co-occurring with the species in the column species in the row. This is the percentage of species classified to polygons!\\
\textit{Output:} data.frame, ncol= number of species + 1, nrow = number of species. The numbers indicate the percentage of the species in the row co-occurring with the species in the column.\\
\\
\textbf{ConvertPoly(x)}\\
\textit{Input:} a character vector indicating the path to a .txt file with polygon information exported from QGIS\\
\textit{Function:} This function re-formats the dataframe to be suitable as input for the SpeciesGeoCoder() function.\\
\textit{Output:} a data.frame that can be exported for used as polygon input file for the SpeciesGeocoder() function\\
\\
\textbf{Cord2Polygon(x)}\\
\textit{Input:} x = a tab delimited text file in the working directory OR a data.frame containing the Polygon information. Three columns: identifier, XCOOR, YCOOR.\\
\textit{Function:} creates spatial polygon objects out of point lists; Projection: latlon, wgs84.\\
\textit{Output:} SpatialPolygons object (=list of polygons).\\
\\
\textbf{CropPointCountry(x,y)}\\
\textit{Input:} x = a data.frame with coordinates of points of interest, 3 columns: identifier, XCOOR, YCOOR; y = a string or vector of strings with the countries of interest.\\
\textit{Function:} crops the point in x to the country borders of y, taken from the �wrld-simpl� data from the maptools package.\\
\textit{Output:} a data.frame, with points within the country borders\\
\\
\textbf{CropPointPolygon(points, polygon, outside)}\\
\textit{Input:} points = data.frame, 3 columns: identifier XCOOR, YCOOR, polygon = polygon of interest as SpatialPolygons object, outside = logical value, T = points inside the polygons, F = points outside the polygons.\\
\textit{Function:} crops a data.frame with point coordinates to a polygon. Depending on outside it returns either a data.frame with the points lying inside or outside the polygon.\\
\textit{Output:} data.frame, with point coordinates\\
\\
\textbf{*GetPythonIn(coordinates, polygon, sampletable, speciestable)}\\
\textit{Input:} coordinates =table of point coordinates, polygon = table of polygon coordinates, sampletable = results of species classification to polygons, speciestable = table of summary per species.\\
\textit{Function:} this is a helper function to pass the objects from the python code of the speciesgeocoder program.\\
\textit{Output:} object of class spgeoOUT\\
\\
\textbf{HeatPlotCoEx(x, �)}\\
\textit{Input:} x = a object of class spgeoOUT OR a data.frame with ncol = identifier, number of species/identifiers; nrow = number of species/identifiers\\
\textit{Function:} creates a heatplot from the coexistence matrix.\\
\textit{Output:} a single heat/level plot.\\
\\
\textbf{MapAll(x,polyg,moreborders)}\\
\textit{Input:} x = an object of class spgeoOUT, than polyg is not necessary, OR a matrix/data.frame of point coordinates 2 columns: XCOOR, YCOOR; polyg a SpatialPolygons object, with polygons of interest, moreborder = logical (T/F).\\
\textit{Function:} if method spgeoOUT than it maps all points and all polygons in the object. If method = matrix plots the points together with the polygons. The �moreborders� option adds borders of countries younger than 1990, default = F.\\
\textit{Output:} a plotted map\\
\\
\textbf{MapPerPoly(x, plotout)}\\
\textit{Input:} x = an object of class spgeoOUT; plotout = logical (T/F)\\
\textit{Function:} creates a series of maps, showing each polygon and its close environment, with all samples classified to this polygon. Species are color-coded. Plotout indicates if the function will be viewed in the R graphics device or passed to another output function, default = FALSE. \\
\textit{Output:} a series of map plots.\\
\\
\textbf{MapPerSpecies(x, moreborders, plotout)}\\
\textit{Input:} x = an object of class spgeoOUT; moreboreders = logical (T/F); plotout = logical (T/F).\\
\textit{Function:} creates one map per species/identifier, showing all occurrence points related and all polygons. Plotout indicates if the function will be viewed in the R graphics device or passed to another output function, default = F. The �moreborders� option, add borders of countries younger than 1990, default = F.\\
\textit{Output}: a series of plotted maps\\
\\
\textbf{MapUnclassified(x, moreborders, �)}\\
\textit{Input:} x = object of class spgeoOUT, moreboreders = logical, should additional borders be added?\\
\textit{Function:} creates a map of all input samples that could not be classified to one of the input polygons. The �moreborders� option, add borders of countries younger than 1990, default = F.\\
\textit{Output:} a plotted map\\
\\
\textbf{NexusOut(x, verbose)}\\
\textit{Input:} x = an object of the class spgeoOUT, verbose = logical(T/F)\\
\textit{Function:} this function creates a table of the species classification to each area in nexus format for the further use in combination with phylogenetic trees. If verbose = T (default = F) the number of occurences per area are included in the file.\\
\textit{Output:} a .nex file in the working directory.\\
\\
\textbf{*OutBarChartPoly(x, �)}\\
\textit{Input:} x = object of class spgeoOUT\\
\textit{Function:} produces a .pdf with a bar chart for each polygon showing the  number of occurrences for all input species in this specific polygon. This is a helper function producing the speciesgeocoder standard pdf from BarChartPoly().\\
\textit{Output:} �barchart\_per\_polygon.pdf� in the working directory\\
\\
\textbf{*OutBarChartSpec(x, \dots)}\\
\textit{Input:} x = object of class spgeoOUT\\
\textit{Function:} produces a .pdf with a bar chart for each species showing the occurrence in all input polygons. . This is a helper function producing the speciesgeocoder standard pdf from BarChartSpec().\\
\textit{Output:} �barchart\_per\_species.pdf� in the working directory\\
\\
\textbf{*OutHeatCoEx(x, �)}\\
\textit{Input:} x = object of class spgeoOUT\\
\textit{Function:} produces a .pdf showing a heat plot, representing the coexistence pattern between the input species. This is a helper function producing the speciesgeocoder standard pdf from HeatPlotCoEx().\\
\textit{Output:} �heatplot\_coexistence.pdf� in the working directory\\
\\
\textbf{*OutMapAll(x, �)}\\
\textit{Input:} x = object of class spgeoOUT\\
\textit{Function:} produces a .pdf showing a map of all points and a map of all points not classified to any polygon. This is a helper function producing the speciesgeocoder standard pdf from MapAll() and MapUnclassified()\\
\textit{Output:} �map\_samples\_overview.pdf� in the working directory\\
\\
\textbf{*OutMapPerPoly(x, �)}\\
\textit{Input:} x = object of class spgeoOUT\\
\textit{Function:} produces a .pdf showing a map of each polygon and its close environment with, all points that were classified to this polygon, color-coded by their identifier. This is a helper function producing the speciesgeocoder standard pdf from MapPerPoly().\\
\textit{Output:} �map\_samples\_per\_polygon.pdf� in the working directory\\
\\
\textbf{*OutMapPerSpecies(x, �)}\\
\textit{Input:} x = object of class spgeoOUT\\
\textit{Function:} produces a .pdf showing a map for each species with all polygons individuals of this species where classified to. This is a helper function producing the speciesgeocoder standard pdf from MapPerSpecies().\\
\textit{Output:} �map\_ per\_species.pdf� in the working directory\\
\\
\textbf{*OutPlotSpPoly(x, �)}\\
\textit{Input:} x = object of class spgeoOUT\\
\textit{Function:} produces a .pdf showing a bar chart of the species number per polygon. This is a helper function producing the speciesgeocoder standard pdf from PlotSpPoly.\\
\textit{Output:} �number\_of\_species\_per\_polygon.pdf� in the working directory\\
\\
\textbf{PipSamp(x)}\\
\textit{Input:} class spgeoIN\\
\textit{Function:} calculates the homepolygon for each gives out a data.frame with the home polygon for each sample\\
\textit{Output:} data frame; 2 columns: sample Id, containing polygon \\
\\
\textbf{PlotOutSpGeo(x, �)}\\
\textit{Input:} x = an object of the class spgeoOUT.\\
\textit{Function:} This function calls all output functions, producing the standard package of output plots for speciesgeocoder.\\
\textit{Output:} .pdf files in the working directory\\
\\
\textbf{PlotSpPoly(x,�)}\\
\textit{Input:} x = object of class spgeoOUT.\\
\textit{Function:} creates a bar chart on species numbers per polygon.\\
\textit{Output:} a bar chart.\\
\\
\textbf{PointInPolygon(x,y)}\\
\textit{Input:} x = data.frame with point coordinates; 3 columns: identifier, XCOOR, YCOOR ; y = data.frame with polygon points, 3 columns: identifier, \\ 
\textit{Function:} performs a point in polygon test, and produces a table indicating the name of homepolygon of each sample as character string.\\
\textit{Output:} data.frame, 2 columns: identifier, homepolygon.\\
\\
\textbf{ReadPoints(x,y)}\\
\textit{Input:} 2 text files in the working directory: x = coordinates of the points of interest, y = the coordinates of the polygons. 3 Columns: identifier, XCOOR, YCOOR.\\
\textit{Function:} creates an object of the class spgoeIN (= list of pointidentifiers, point coordinate, spatial polygons\\
\textit{Output:} object of class spgeoIN\\
\\
\textbf{SpeciesGeoCoder(x, y, coex, graphs)}\\
\textit{Input:} 2 text files in the working directory: x = coordinates of the points of interest, y = the coordinates of the polygons. 3 Columns: identifier, XCOOR, YCOOR.\\
\textit{Function:} the main function of the package. This performs the whole species geocoder and produces the standard package of output files. Produces a number of standard output-tables containing: 1. classification of all samples to a polygon, 2. Summary of species (identifier) occurrence per polygon, 3. A table of samples that could not be classified to any of the input polygons, 4. a Nexus-file, including the species classification, 5. A coexistence matrix, showing to which percentage species to co-occurr in the input polygons, 5. A table giving species numbers per polygon. Furthermore produces a set of .pdf files in the output directory: 1. A barchart showing the number of species per polygon, 2. a barchart summarizing numbers of each species for each polygon, 3. A bar chart summarizing the occurrences in each polygon per species, 4. A map of all polygons with the points classified to them, colored for species (identifier), 5. a map of the occurrences of all species, A map showing all points used and all unclassified points in the geographic context, 6. A heat plot showing the co-occurrence patterns of all species in the polygons.\\
\textit{Output:} multiple tab delimited tables and graphics in pdf format.\\
\\
\textbf{SpGeoCod(x, y)}\\
\textit{Input:} x = .txt file containing the information of species occurrence, 3 columns: identifier,XCOOR,YCOOR; y = points comprising the polygons, 3 columns: identifier, XCOOR, YCOOR.\\
\textit{Function:} this function combines ReadPoints() and SpGeoCodH() to produce an object of the class spgeoOUT from input text files.\\
\textit{Output:} object of class spgeoOUT\\
\\
\textbf{SpGeoCodH(x)}\\
\textit{Input:} object of class spgeoIN.\\
\textit{Function:} this is one of the core functions. It uses an object of the class spgeoIN and performs appoint in polygon test classifying each species to a polygon, summarizes the information per species, summarizes the number of species per polygon, produces a table  showing the samples that could not be classified and calculates a coexistence matrix. These objects are then put together with the input information to an object of the class spgeoOUT.\\
\textit{Output:} spgeoOUT\\
\\
\textbf{spPerPol(x)}\\
\textit{Input:} class spgeoIN\\
\textit{Function:} combines PipSamp(), SpSumH and SpPerPolH;\\
\textit{Output:} a named vector with species number per \\
\\
\textbf{*spPerPolH(x)}\\
\textit{Input:} data.frame, ncol = number of polygons, nrow = number of species. This is a helper function, which takes input directly from SpSumH().\\
\textit{Function:} calculates the number of species per polygon\\
\textit{Output:} a named vector, with species number per polygon.\\
\\
\textbf{spSum(x)}\\
\textit{Input:} x = object of class spgeoIN\\
\textit{Function:} calculates a summary of the number ofspecies occurences per polygon.\\
\textit{Output:} a data.frame summarizing the occurrence number of species per polygon; ncol = number of polygons, nrow = number of species\\
\\
\textbf{*spSumH(x)}\\
\textit{Input:} x = class spgeodataframe, this is a helper function to take output from pipSamp\\
\textit{Function:} calculates a summary of species occurrences from a 2 column table: identifier, hompolygon\\
\textit{Output:} A data.frame summarizing the occurrence number of species per polygon.\\
Uses output of pipSamp to give out a dataframe of number of species occurrences per polygon, ncol = number of polygons, nrow = number of species\\
\\
\textbf{WriteTablesSpGeo(x, �)}\\
\textit{Input:} object of class spgeoOUT\\
\textit{Function:} creates 5 output - tables as tab delimited text files in the working directory: 1. classification of all samples to a polygon, 2. Summary of species (identifier) occurrence per polygon, 3. A table of samples that could not be classified to any of the input polygons, 4. A coexistence matrix, showing to whichpercentage species to co-occurr in the input polygons, 5. A table giving species numbers per polygon\\
\textit{Output:} tab delimited .txt files in the working directory.\\
\\
\textbf{WWFconvert(x)}\\
\textit{Input:} x = SpatialPolygonsDataframe object of the biomes and ecoregions of the WWF or any subset of it. Available from http://maps.tnc.org/gis\\data.html, and loaded to R with readShapeSpatial() from the raster package\\
\textit{Function:} converts the polygons in the object to a list of points\\
\textit{Output:} data.frame, 3 columns, identifier,XCOOR,YCOOR\\
\\
\textbf{WWFnam(x)}\\
\textit{Input:} x = a SpatialpolygonsDataFrame of the biomes and ecoregions of the WWF or any subset of it. Available from http://maps.tnc.org/gis\\data.html, and loaded to R with readShapeSpatial() from the raster package\\
\textit{Function:} shows all available subset categories for the of the dataset for WWFpick() and WWFpoly2point().\\
\textit{Output:} A list of strings\\
\\
\textbf{WWFpick(x, name, scale)}\\
\textit{Input:} x = a SpatialpolygonsDataFrame of the biomes and ecoregions of the WWF or any subset of it. Available from http://maps.tnc.org/gis\\data.html, and loaded to R with readShapeSpatial() from the raster package; name = name of the realm, biome or ecoregion of interest, scale = character string indicating the scale of interest (one of: �REALM�, �BIOME�, �ECOREGION�).\\
\textit{Function:} creates a subset of the WWF ecoregion Polygons\\
\textit{Output:} class SpatialPolygonsDataFrame\\
\\
\textbf{WWFpoly2point(x, name, scale)}\\
\textit{Input:} x = a SpatialpolygonsDataFrame of the biomes and ecoregions of the WWF or any subset of it. Available from http://maps.tnc.org/gis\\data.html, and loaded to R with readShapeSpatial() from the raster package; name = name of the realm, biome or ecoregion of interest, scale = character string indicating the scale of interest (one of: �REALM�, �BIOME�, �ECOREGION�).\\
\textit{Function:} combines WWFpick() and WWFconvert(). Produces a list of points defining the realm, biome or ecoregion defined in the input.\\
\textit{Output:} data.frame, 3 columns, identifier,XCOOR,YCOOR\\

\chapter{Benchmarking}

\centering
\includegraphics[width=0.9\textwidth]{figures/bm_no_graphics.eps}\\
\vspace{2cm}
\includegraphics[width=0.9\textwidth]{figures/bm_graphics.eps}


\end{document}